#!/bin/sh

. $EXTERNALS_CONFIG

tar zxvf log4cpp-1.0-3.tar.gz

patch -p0 -i errors.patch
if [ $? -ne 0 ]
then
	echo "patch errors.patch failed!"
	exit 1
fi

patch -p0 -i configure.patch
if [ $? -ne 0 ]
then
	echo "patch configure.patch failed!"
	exit 1
fi

cd log4cpp-1.0 && echo Changed directory to `pwd`

# This version of log4cpp is used to build the CREAM client libraries.
# The tarball was downloaded from
#  http://eticssoft.web.cern.ch/eticssoft/repository/externals/log4cpp/1.0/src/log4cpp-1.0-3.tar.gz
# It's identical to the original release, except for a small bugfix.

./configure --prefix=$PACKAGE_INSTALL_DIR
if [ $? -ne 0 ]
then
        echo "configure failed!"
        exit 1
fi

make
if [ $? -ne 0 ]
then
        echo "make failed!"
        exit 1
fi

make check
if [ $? -ne 0 ]
then
        echo "make check failed!"
        exit 1
fi

make install
if [ $? -ne 0 ]
then
        echo "make install failed!"
        exit 3
fi

exit 0;
