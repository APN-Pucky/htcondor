%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\label{sec:History-7-3}Development Release Series 7.3}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This is the development release series of Condor.
The details of each version are described below.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-3-2}Version 7.3.2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item The format of the output from \Condor{status} \Opt{-grid} has been 
changed to provide more useful information.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item The \Condor{status} command is now substantially faster, 
especially with the \Opt{-format} option.

\item When low on file descriptors for creating new network sockets,
the \Condor{schedd} daemon now avoids unlimited stacking up of
messages that it sends periodically to the \Condor{negotiator} 
and \Condor{startd}.

% gittrac #429
\item The performance and failure handling of the Grid Monitor have been
improved.

% gittrac #356
\item For grid type \SubmitCmd{nordugrid} in the grid universe,
job status information
is now obtained using Nordugrid ARC's LDAP server, which should greatly
improve performance. Also, Condor can now tell when these jobs are running.

%gittrac #527
\item Added a \Opt{-valgrind} flag to \Condor{submit\_dag}, which
causes \Condor{submit\_dag} to generate a submit file that runs
\emph{valgrind} on \Condor{dagman}.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

% gittrac 331
\item The new configuration variable \Macro{SlotWeight} may be used to
give a slot greater weight when calculating usage, computing fair
shares, and enforcing group quotas.  For example, claiming a slot with
\Expr{SlotWeight = 2} is equivalent to claiming two \Expr{SlotWeight =
1} slots.  The default value is \AdAttr{Cpus}, the number of CPUs
associated with the slot, which is 1 unless specially configured.  Any
expression referring to attributes of the slot ClassAd and evaluating
to a positive floating point number is valid.


% gittrac 586
\item The new configuration variable \Macro{DAGMAN\_USER\_LOG\_SCAN\_INTERVAL}
controls how long \Condor{dagman} waits between checking job log files
for status updates.
See \ref{param:DAGManUserLogScanInterval} for more details.

\item The new configuration variable \Macro{MAX\_PERIODIC\_EXPR\_INTERVAL}
  implements a ceiling on the time between evaluation of periodic expressions,
  due to the adaptive timing implied by the configuration variable
  \MacroNI{PERIODIC\_EXPR\_TIMESLICE}.
  See \ref{param:MaxPeriodicExprInterval} for more details.

% gittrac #475
\item The new configuration variable \Macro{GRIDMANAGER\_SELECTION\_EXPR}
can be used to control how many \Condor{gridmanager} processes will be
spawned to manage grid universe jobs. 
See \ref{param:GridManagerSelectionExpr} for more details.

% gittrac #207
\item The configuration variable
\Macro{GRIDMANAGER\_MAX\_PENDING\_SUBMITS\_PER\_RESOURCE} and the
corresponding throttle \Macro{GRIDMANAGER\_MAX\_PENDING\_SUBMITS}
have been removed.

% gittrac #429
\item The new configuration variable \Macro{GRID\_MONITOR\_DISABLE\_TIME}
controls how long the \Condor{gridmanager} will wait after encountering
an error before attempting to restart a Grid Monitor job.
See \ref{param:GridMonitorDisableTime} for more details.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

% gittrac #504
\item Fixed a bug in the Windows platform code that treats scripts as
  executables.
  Unknown file extensions were treated as an error,
  rather than as a Windows executable.

\item The \Condor{job\_router} sets the ClassAd attribute
\Attr{EnteredCurrentStatus} to the current time when creating a new routed job.
Previously, it copied this attribute from the original job.

\item The \Condor{job\_router} emits a more friendly log message when it
observes that the routed copy of the job was removed.

\item A fix has been made for a problem seen in 7.3.1 in which Condor daemons
using CCB to connect to other Condor daemons would sometimes consume
large amounts of CPU time for no good reason.

\item In rare failure cases, attempts to connect via CCB could stay in
a pending state indefinitely.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-3-1}Version 7.3.1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item None.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Implemented a performance increase to \Condor{dagman} which can
decrease the parsing times of DAG input files by up to 60 times.
This performance increase works for certain common DAG geometries.
This will help in submission and recovery
time for DAGs whose nodes have a very large number of dependency edges
associated with them.

\item \Condor{q} -analyze and -better-analyze now emit warnings
if the \Condor{schedd} will not run jobs when it is out of swap space or
has hit the limit imposed by the configuration variable
\MacroNI{MAX\_JOBS\_RUNNING}.

\item When matching Condor-G jobs to resources, if multiple jobs
match multiple resources, and every job has identical job rank, the
matchmaker would always fill up one particular resource first.  Now,
the resources will be matched in a round robin fashion.  This can be
overridden by setting job rank appropriately.

\item Made the \Condor{schedd} more efficient in how it stores
information about \verb@$$()@ expansions in the job ClassAd.
Also made the \Condor{schedd} more efficient in how it contacts
the \Condor{negotiator} to submit reschedule requests.

\item Improved the Job Router's heuristic for site throttle adjustment.  It
is now quicker to release the throttle when the failure rate drops
below the configured threshold.

\item Made the Job Router more efficient on startup by improving the way it
reads the job queue log file.

\item Added an accessor class to the user log reader API to allow the
  application to query about reader state, including the
  difference in the event numbers and log position of two states.  This
  can be used by the application to determine the number of events
  missed when missed events are detected.

\item Added the ability to throttle the rate at which jobs are
stopped via \Condor{rm}, \Condor{hold}, \Condor{vacate\_job},
and during a graceful shutdown of the \Condor{schedd} daemon.

\item In the configuration file, Condor now accepts expressions for
the values of configuration variables that are required to be 
numeric literals or boolean constants.  
Note that this does not imply that the
expressions may freely reference ClassAd values in places where they
could not before.  
See section~\ref{sec:Intro-to-Config-Files} for an example with
further explanation.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item The new configuration variable \Macro{UPDATE\_OFFSET} 
  causes the \Condor{startd} to
  delay the initial (and all further) updates that it sends to the
  \Condor{collector}.  See \ref{param:UpdateOffset} for more details.

\item The new configuration variables
  \Macro{JOB\_STOP\_COUNT} and \Macro{JOB\_STOP\_DELAY}
  limit the rate at which jobs are stopped via \Condor{rm},
  \Condor{hold}, \Condor{vacate\_job}, and during a graceful shutdown of
  the \Condor{schedd} daemon.
  See \ref{param:JobStopCount} and \ref{param:JobStopDelay} 
  for full definitions.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a problem with job removal in the local universe that 
  would cause spurious error messages to be written to the log of the
  \Condor{schedd} daemon.

\item The \Condor{schedd} was failing to send `reschedule' commands to
flocked negotiators, so unless some other schedd in the negotiator's
pool sent it a reschedule command, negotiation cycles would only
happen every \Macro{NEGOTIATOR\_INTERVAL}.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item When using CCB to connect to other Condor daemons, Condor 7.3.1
daemons can sometimes consume large amounts of CPU, potentially
causing performance problems.  Condor 7.3.0 did not suffer from this
problem.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-3-0}Version 7.3.0}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This release is incompatible when communicating with
previous versions of Condor if CCB is enabled or if
\Macro{PRIVATE\_NETWORK\_NAME} is configured.

\item Updated the DRMAA version.
This new version is compliant with GFD.133,
the DRMAA 1.0 grid recommendation standard.
Three new functions were added to meet the specification's requirements,
and several bugs were fixed.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added support for using any recognized script as an executable
in a submit file on Windows. For more information please see
section~\ref{sec:windows-scripts-as-executables} on
page~\pageref{sec:windows-scripts-as-executables}.

\item Improved support for private networks:
Added CCB, the Condor Connection Broker.  It is similar in
functionality to GCB, the Generic Connection Broker, but it has
several advantages, including ease of use and working on Windows as
well as Unix platforms.
GCB continues to work, but we may remove
it some time in the 7.3 development series.  The main missing feature
in CCB at the moment that prevents it from replacing GCB,
is support for connectivity from one private network to another.
CCB only works
when connecting from a public network to a private one.  For example,
jobs may be sent from a \Condor{schedd} on the public Internet to 
\Condor{startd} daemons on a
private network, if the \Condor{startd} daemons are configured
to use a CCB server that is accessible to the \Condor{schedd} daemon.
However, if the \Condor{schedd} daemon is on one private
network and the \Condor{startd} daemons are on a different private network,
CCB does not help.  For more information on CCB, see section~ \ref{sec:CCB}.

\item Added support for a CPU affinity on both Windows and Linux platforms.

\item Added support for the \Condor{q} \Opt{-better-analyze} option on Windows.

\item Added \MacroNI{WANT\_HOLD}.  When \MacroNI{PREEMPT} becomes
true, if \MacroNI{WANT\_HOLD} is true, the job is put on hold for the
reason (optionally) specified by \MacroNI{WANT\_HOLD\_REASON} and
\MacroNI{WANT\_HOLD\_SUBCODE}.  These policy expressions are evaluated
by the execute machine.  As usual, the job owner may specify
\AdAttr{periodic\_release} and/or \AdAttr{periodic\_remove}
expressions to react to specific hold states automatically.

\item Added the ClassAd function \Procedure{debug}.
See section~ \ref{sec:classadFunctions} for the details of this function.

% Commented out by Karen, as this is useless to a user taking the
% time to read a version history. More info is needed. 
%\item Log messages have been made more clear.
% Includes: Give a clear warning instead of a terse error, when lacking a COLLECTOR.

\item The \Condor{schedd} can now use MD5 check sums to avoid storing
multiple copies of the same executable in its \Macro{SPOOL} directory.
Note that this feature only affects executables sent to the
\Condor{schedd} via the \SubmitCmd{copy\_to\_spool} command within
a submit description file.

% gittrac #197
\item Reduced the number of sleeps \Condor{dagman} does to maintain log
file consistency when a DAG uses multiple user logs for node jobs.
DAGMan now does one sleep per submit cycle,
instead of one sleep for each submit.

% gittrac #166, #208
\item Added the \Opt{-import\_env} command-line flag to
\Condor{submit\_dag}.  This explicitly puts the submittor's environment
into the \File{.condor.sub} file.

\item Optimized the removal of large numbers of jobs.  
Previously, removal of tens of thousands of jobs caused the
\Condor{schedd} daemon to consume
a lot of CPU time for several minutes.

\item Reduced memory usage by the \Condor{shadow} daemon.  Since there is one
\Condor{shadow} process per running job, this helps increase the
number of running jobs that a submit machine can handle.  Under Linux 2.6,
we found that running 10,000 jobs from a single submit machine
requires about 10GBytes of system RAM.  We also found in this case that to
run more than 10,000 simultaneous jobs requires a 64-bit submit
machine.  On a 32-bit Linux platform, kernel memory is exhausted,
regardless of how much additional RAM the system has.

\item Reduced the memory usage of the \Condor{collector} daemon,
when \Expr{UPDATE\_COLLECTOR\_WITH\_TCP = True}.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item The new configuration variable \Macro{OPEN\_VERB\_FOR\_<EXT>\_FILES}
allows the default interpreter for scripts with an extension \textit{EXT} to
be changed.  For more information please see
section~\ref{sec:windows-scripts-as-executables} on
page~\pageref{sec:windows-scripts-as-executables}.

\item The new configuration variable \Macro{CCB\_ADDRESS}
configures a daemon to use one or more
CCB servers to allow communication with Condor components outside of
the private network.  See page~\pageref{sec:CCB}.

\item The new configuration variable \Macro{MAX\_FILE\_DESCRIPTORS}
(on Unix platforms only) specifies the
required file descriptor limit for a Condor daemon.  File descriptors
are a system resource used for open files and for network connections.
Condor daemons that make many simultaneous network connections may
require an increased number of file descriptors.  For example, see
page~\pageref{sec:CCB} for information on file descriptor requirements
of CCB.

\item The new configuration variables \Macro{ENFORCE\_CPU\_AFFINITY} and 
\Macro{SLOTx\_CPU\_AFFINITY} on Linux platforms allow for
Condor to lock slots to given CPUs.
Definitions for these variables are at \ref{param:EnforceCpuAffinity}.

\item The new configuration variable \Macro{DEBUG\_TIME\_FORMAT}
  allows a custom specification for the format of the time
  printed at the start of each line in a daemon's log file.
  See \ref{param:DebugTimeFormat} for the complete definition of
  this variable.

\item The new configuration variable \Macro{SHARE\_SPOOLED\_EXECUTABLES}
  is a boolean value that determines whether the \Condor{schedd} daemon will
  use MD5 check sums to avoid storing multiple copies of the same
  executable in the \MacroNI{SPOOL} directory. The default setting is
  \Expr{True}.

\item The new boolean configuration variable
  \Macro{EVENT\_LOG\_FSYNC} provides control of the behavior of
  Condor when writing events to the event log.  Previously,
  the behavior was as if this parameter were set to \Expr{False}.
  See \ref{param:EventLogFsync} for the complete definition of
  this variable.

\item The new boolean configuration variable
  \Macro{EVENT\_LOG\_LOCKING} provides control of the behavior of
  Condor when writing events to the event log.  Previously,
  the behavior was controlled by \MacroNI{ENABLE\_USERLOG\_LOCKING}.
  See \ref{param:EventLogLocking} for the complete definition of
  this variable.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item None.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}
