%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\label{sec:History-7-0}Stable Release Series 7.0}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This is a stable release series of Condor.
It is based on the 6.9 development series.
All new features added or bugs fixed in the 6.9 series are available
in the 7.0 series.
As usual, only bug fixes (and potentially, ports to new platforms)
will be provided in future 7.0.x releases.
New features will be added in the 7.1.x development series.

The details of each version are described below.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-0-1}Version 7.0.1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Fixed a bug in Condor's authorization policy reader.  The bug
affects cases where the policy (\MacroNI{ALLOW}/\MacroNI{DENY} and
\MacroNI{HOSTALLOW}/\MacroNI{HOSTDENY} settings) mixes host-based
authorizations with authorizations that refer to the authenticated
user name.  In some cases, this bug would result in host-based
settings not being applied to authenticated users.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item Windows now has support for Backfill Jobs. For more information on
      this, please see section~\ref{sec:Backfill-BOINC-Windows} on
      page~\pageref{sec:Backfill-BOINC-Windows}.

\item Condor has been ported to Redhat Enterprise Linux
5.0 running on the 32-bit x86 architecture and on the 64-bit x86\_64
architecture.

% This feature was added in 6.7, but condor_submit wasn't changed.
% Until now, the user had to set this via the '+' notation in the submit
% file.
\item The command \SubmitCmd{email\_attributes} in a job submit
description file defines a set of job ClassAd attributes whose values
should be included in the e-mail notification of job completion.

\item The configuration variable \MacroNI{CONDOR\_VIEW\_HOST} may now
contain a port number and may (if desired) refer to a
\Condor{collector} daemon running on the same host as the
\Condor{collector} that is forwarding ads.  It is also now possible to
use the forwarded ads for matchmaking purposes.  For example, several
collectors could forward ads to a single aggregating collector which
a \Condor{negotiator} then uses as its source of information for
matchmaking.

\item \Condor{configure} (and \Condor{install}) now detects missing
  shared libraries (such as libstdc++.so.5 on Linux), and prints
  messages and exits if missing libraries are detected.  A new command
  line option \Opt{--ignore-missing-libs} will cause it to not exit
  after the messages have been printed, and to proceed with the
  installation.

\item Added a \Opt{--force} command line option to \Condor{configure}
  (and \Condor{install}) which will turn on \Opt{--overwrite} and
  \Opt{--ignore-missing-libs}.

\item \Condor{configure} now writes simple sh and csh shell scripts
  which can be sourced by their respective shells to set the user's
  PATH and CONDOR\_CONFIG environment variables.  By default, these
  are created in the root of the Condor installation, but this can be
  changed via the \Opt{--env-scripts-dir} command line option.  Also,
  the creation of these scripts can be disabled with the
  \Opt{--no-env-scripts} command line option.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item Added \MacroNI{STARTER\_UPLOAD\_SECONDS}. This prevents a hang if 
the \Condor{shadow} delays a write for more than the specified time.
The default is 300.

\item Added \MacroNI{CKPT\_PROBE}. This specifes an internal to Condor
executable which determines information about how a process is layed out
in memory--in addition to other information. This program is not available
on Windows at this time.

\item Added \MacroNI{CKPT\_SERVER\_CHECK\_PARENT\_INTERVAL}.  Unlike
other Condor daemons, the checkpoint server was not checking to see if
its parent (the \Condor{master}) has gone away unexpectedly.  Now it
does, and it shuts itself down if this happens.  The default interval
for checking is 120 seconds.  Setting this parameter to 0 disables the
check.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed file descriptor leak in \Condor{schedd} when using the SOAP
interface.

\item Fixed a bug that primarily affected pools with
\MacroNI{MaxJobRetirementTime} (0 by default) set larger than
\MacroNI{REQUEST\_CLAIM\_TIMEOUT} (30 minutes by default).  Since
6.9.3, when the schedd timed out requesting a claim to a slot, the
\Condor{startd} was not made aware of the cancelled request.  This
resulted in some wasted time (up to \MacroNI{ALIVE\_INTERVAL}) in
which the \Condor{startd} would wait for a job to run.

\item A problem with \Condor{history} in a quill environment incorrectly
interpreting the -name argument has been fixed.

\item A memory leak that prevented \Condor{load\_history} from running
with large history files has been fixed.

\item A bug in \Condor{history} when running in a quill environment has been fixed.  This bug would cause the command to crash in some situations.

\item The job ClassAd attribute \Attr{EmailAttributes} now works 
for grid universe jobs.

\item In 32-bit Linux, the job queue database file may now exceed 2GB.
Previously, the \Condor{schedd} would halt with an error when trying
to write past the 2GB mark.

\item In 32-bit Linux, \Condor{history} can now read from history files
larger than 2GB \emph{except} when using the -backwards option.

\item Local universe jobs are now scheduled to run more promptly.  Previously,
new local universe jobs would sometimes take up to \MacroNI{SCHEDD\_INTERVAL}
(default 5 minutes) to be considered for running.

\item The memory usage of \Condor{collector} used to grow over time if
daemons with new names kept joining and then leaving the pool (e.g. a
glidein pool).  This was due to statistics on dropped updates that
accumulated for all daemons that ever advertised themselves to the
collector.  These statistics are now periodically purged of
information about daemons which have not reported in a long time.  How
long is controlled by \MacroNI{COLLECTOR\_STATS\_SWEEP}, which
defaults to 2 days.

\item Condor daemons would die when trying to send ClassAd
advertisements to a hostname that could not be resolved by DNS.

\item Since 6.9.5, file transfer errors for vanilla, java, or parallel
jobs would sometimes not result in the job going on hold as it should.
This was most likely for very small files that failed to be written
for some reason.

\item The \AdAttr{ImageSize} reported for jobs on AIX was too big by a factor
of 1024.

\item Since 6.9.5, \Condor{glidein} failed in the setup stage, due to the
change in syntax of quoting in the Condor submit file for gt2 argument strings.

\item Fixed a bug in the \Condor{gridmanager} that could prevent refreshed
X509 proxies from being forwarded to the remote machine for grid universe
jobs of type gt4.

\item Fixed a bug in Condor's authorization policy reader.  The bug
affects cases where the policy (\MacroNI{ALLOW}/\MacroNI{DENY} and
\MacroNI{HOSTALLOW}/\MacroNI{HOSTDENY} settings) mixes host-based
authorizations with authorizations that refer to the authenticated
user name.  In some cases, this bug would result in host-based
settings not being applied to authenticated users.

\item Fixed a problem affecting the GSI and SSL authentication
methods.  When these methods successfully authenticated the user but
failed to find a mapping of the X509 name to a condor user id, they
were setting the authenticated name to \verb|gsi| and \verb|ssl|
respectively.  However, these names contain no domain, so they could
not be referred to in the authorization policy.  Now these anonymous
mappings are \verb|gsi@unmappeduser| and \verb|ssl@unmappeduser|.
Therefore, to deny access by users who are not explicitly mapped in
the map file, you could do this:

\begin{verbatim}
DENY_READ = *@unmappeduser
DENY_WRITE = *@unmappeduser
\end{verbatim}

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item When using \Condor{compile} with the RHEL5 x86 port of Condor to
produce a standard universe executable, one will see a warning message
about how linking with dynamic libraries is not portable. This warning
is erroneous and should be ignored. It will be fixed in a future version
of Condor.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-0-0}Version 7.0.0}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item PVM support has been dropped.

\item The time zone for the \Prog{PostgreSQL} 8.2 database
  used with Quill on Windows machines must be explicitly set
  to use an abbreviation.
  This Windows environment variable is \verb@TZ@.
  Proper abbreviations for the value of this variable may be found
  within the \Prog{PostgreSQL} installation in a file,
  \File{share/timezonesets/<continent>.txt}, where
  \verb@<continent>@ is replaced by the continent of the 
  desired time zone.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item The Windows MSI installer now supports VM Universe.

\item Eliminated the ``tarball in a tarball'' in our distribution.
  The contents of \File{release.tar} from the distribution tarball
  (for example, \File{condor-6.9.6-linux-x86-centos45-dynamic.tar.gz}) is now
  included in the distribution tarball.

\item Updated \Condor{configure} to match the above change.  The
  \Opt{--install} option now takes a directory path as its parameter,
  for example \Opt{--install=/path/to/release}.
  It previously took the path to
  the \File{release.tar} tarball.

\item Added \Condor{install}, which is a symlink to \Condor{configure}.
  Invoking 
\begin{verbatim}
    condor_install
\end{verbatim}
  is identical to running
\begin{verbatim}
    condor_configure --install=.
\end{verbatim}

\item Added the option \Opt{--prefix=dir} to \Condor{configure} and
  \Condor{install}.  This is an alias for \Opt{--install-dir=dir}.

\item Added the option \Opt{--backup} option to \Condor{configure} and
  \Condor{install}.  This option renames the target \File{sbin} directory,
  if the \Condor{master} daemon exits while in the target \File{sbin} directory.
  Previous versions of \Condor{configure} did this by default.

\item Changed the default behavior of \Condor{install} to exit with a
  warning if the target \File{sbin} directory exists,
  the \Condor{master} daemon is in the \File{sbin} directory,
  and neither the \Opt{--backup} nor \Opt{--overwrite} options are specified.
  This prevents \Condor{install} from improperly moving an \File{sbin}
  directory out of the way.
  For example,
\begin{verbatim}
    condor_install --prefix=/usr
\end{verbatim}
  will not move \File{/usr/sbin} out of the way unless
  the \Opt{--backup} option is also specified.

\item Updated the usage summary of \Condor{configure} and
  \Condor{install} to be much more readable.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item The new configuration variable
  \Macro{DEAD\_COLLECTOR\_MAX\_AVOIDANCE\_TIME} defines the maximum
  time in seconds that a daemon will fail over from a primary
  \Condor{collector} to a secondary \Condor{collector}.
  See section~\ref{param:DeadCollectorMaxAvoidanceTime} on
  page~\pageref{param:DeadCollectorMaxAvoidanceTime} for a
  complete definition.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a memory leak in the \Condor{procd} daemon on Windows.

\item Fixed a problem that could cause Condor daemons to crash if a
  failure occurred when communicating with the \Condor{procd}.

\item Fixed a couple of problems that were preventing the
  \Condor{startd} from properly removing per-job directories
  when running with PrivSep.

\item The \Condor{startd} will no longer fail to initialize, 
  claiming the \MacroNI{EXECUTE} directory has improper permissions,
  when PrivSep is enabled.

\item Lookups of ClassAd attribute \Attr{CurrentTime} are now
  case-insensitive, just like all other attributes.

\item Fixed problems causing the following error message in the log file:

\footnotesize
\begin{verbatim}
ERROR: receiving new UDP message but found a short message still waiting to be closed (consumed=1). Closing it now.
\end{verbatim}
\normalsize

\item The existence of the executable given in the submit file is now 
  enforced (when transferring the executable and not using VM 
  universe).

\item The copy of \Condor{dagman} that ships with Condor is now automatically 
  added to the list of trusted programs in the Windows Firewall.

\item Removed \SubmitCmd{remove\_kill\_sig} from the submission file
  generated by \Condor{submit\_dag} on Windows.

\item Fixed the algorithm in the \Condor{negotiator} daemon, which
  with large numbers of machine ClassAds (for example, 10,000) 
  was causing long delays at the 
  beginning of each negotiation cycle.

\item Use of \MacroNI{MAX\_CONCURRENT\_UPLOADS} was resulting in a
  connection attempt from the \Condor{shadow} to the \Condor{schedd} with a
  fixed 10 second timeout, which is sometimes too small.  This timeout
  has been increased to be the same as other connection timeouts between
  the \Condor{shadow} and the \Condor{schedd}, and it now respects
  \MacroNI{SHADOW\_TIMEOUT\_MULTIPLIER}, so it can be adjusted if necessary.

\item Fixed a problem with \Macro{MAX\_CONCURRENT\_UPLOADS} and
  \Macro{MAX\_CONCURRENT\_DOWNLOADS}, which was sometimes allowing
  more than the configured number of concurrent transfers to happen.

\item Fixed a bug in the \Condor{schedd} that could cause it to crash due
  to file descriptor exhaustion when trying to send messages to hundreds of
  \Condor{startd}s simultaneously.

\item Fixed a 6.9.4 bug in the \Condor{startd} that would cause it to crash
  when a BOINC backfill job exited.

\item Since 6.9.4, when using glExec, configuring \MacroNI{SLOTx\_EXECUTE}
  would cause \Condor{starter} to fail when starting the job.

\item Fixed a bug from 6.9.5 which caused authentication failure for
  the pool password authentication method.

\item Fixed a bug that caused Condor daemons to crash when encountering
  some types of invalid ClassAd expressions.

\item Fixed a bug under Linux that could cause multi-process daemons
  lacking a log lock file to crash while rotating logs that have reached
  their maximum configured size.

\item Fixed a bug under Windows that sometimes caused connection attempts
  between Condor daemons to fail with Windows error number 10056.

\item Fixed a problem in which there are multiple 
  \Condor{collector} daemons in a pool
  for fault tolerance.  If the primary \Condor{collector} failed, the
  \Condor{negotiator} would fail over to the secondary \Condor{collector}
  indefinitely (or until the secondary \Condor{collector} also failed or the
  administrator ran \Condor{reconfig}).  This was a problem for users
  flocking jobs to the pool, because flocking currently only works with
  the primary \Condor{collector}.  Now, the \Condor{negotiator} will fail over
  for a restricted amount of time, up to
  \Macro{DEAD\_COLLECTOR\_MAX\_AVOIDANCE\_TIME} seconds.  The default
  is one hour, but if querying the dead primary \Condor{collector}
  takes very little
  time to fail, the \Condor{negotiator} may retry more frequently
  in order to remain
  responsive to flocked users.

\item Fixed a problem preventing the use of \Condor{q} \Opt{-analyze}
  with the \Opt{-pool} option.

\item Fixed a problem in the \Condor{negotiator} in which machines go
  unassigned when user priorities result in the machines getting split
  into shares that are rounded down to 0.  For example if there are 10
  machines and 100 equal priority submitters, then each submitter was
  getting 0.1 machines, which got rounded down to 0, so no machines were
  assigned to anybody.  The message in the \Condor{negotiator} log in this case
  was this:

\footnotesize
\begin{verbatim}
Over submitter resource limit (0) ... only consider startd ranks
\end{verbatim}
\normalsize

\item Fixed a problem introduced in 6.9.3 that would cause daemons to
  run out of file descriptors if they create sub-processes and are
  configured to use a lock file for the debug log.

\item Standard universe jobs now work properly when using PrivSep.

\item Fixed problem with PrivSep mode where a job that dumps core would
  not get the core file transferred back to the the submit host if the
  \SubmitCmd{transfer\_output\_files} submit option were used.

\item Fixed a bug that caused the \Condor{starter} to crash if a job
called \Condor{chirp} with the \Expr{get\_job\_attr} option.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}

