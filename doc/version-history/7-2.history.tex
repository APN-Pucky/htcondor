%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\label{sec:History-7-2}Stable Release Series 7.2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This is a stable release series of Condor.
As usual, only bug fixes (and potentially, ports to new platforms)
will be provided in future 7.2.x releases.
New features will be added in the 7.3.x development series.

The details of each version are described below.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-2-2}Version 7.2.2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item None.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item None.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item None.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed two seemingly small memory leaks in Condor's SOAP
interface. A small amount of memory was lost per SOAP transaction. On
a high traffic machine, this leak would eventually render the
\Condor{schedd} daemon unresponsive.

\item Fixed a bug in Condor's hibernation facilities, where if any slot
satisfied the \MacroNI{HIBERNATE} expression, the machine would enter
a low power state.

\item Fixed a bug in the parallel universe where periodic expressions
involving the \Attr{JobStatus} attribute would not function properly.

\item Fixed a bug where Condor daemons could segmentation fault while trying
to write a core file to disk in the Unix ports.

\item Fixed a bug in which the use of dedicated execute accounts
(indicated by use of the configuration variable
\MacroNI{DEDICATED\_EXECUTE\_ACCOUNT\_REGEXP}) did not work properly
in PrivSep mode (with the configuration variable \MacroNI{PRIVSEP\_ENABLED}
set to \Expr{True}).

\item Fixed an erroneous log message that reported that
the hook defined by \Macro{HOOK\_UPDATE\_JOB\_INFO} had run,
but would print the \MacroUNI{HOOK\_PREPARE\_JOB} path.
The correct hook ran, so this was only a logging error.
The log message is only visible at the \Expr{D\_FULLDEBUG} level.

% PR 953
\item Fixed a bug that caused \Condor{dagman} to crash if the
\File{dagman.out} file reached a size of 2 GBytes.

\item The new boolean configuration variable
  \Macro{EVENT\_LOG\_FSYNC} provides control of the behavior of
  Condor when writing events to the event log.  Previously,
  the behavior was as if this parameter were set to \Expr{False}.
  See \ref{param:EventLogFsync} for the complete definition of
  this variable.

\item The new boolean configuration variable
  \Macro{EVENT\_LOG\_LOCKING} provides control of the behavior of
  Condor when writing events to the event log.  Previously,
  the behavior was controlled by \MacroNI{ENABLE\_USERLOG\_LOCKING}.
  See \ref{param:EventLogLocking} for the complete definition of
  this variable.

% PR 953
\item Fixed a bug that caused \Condor{dagman} to crash if the
\File{dagman.out} file reached a size of 2 GB.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item Added a note about the fact that environment values specified
with the \Opt{environment} submit description file command override values from
the submittor's environment, as imported with \Opt{getenv = True}.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-2-1}Version 7.2.1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This release addresses reported 7.2.0 problems with the
Windows distribution.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Condor now has a clipped port to i386 Debian 5.0 (Lenny).

\item Added standard universe support for \Prog{gfortran}.

\item Added support for standard output and standard error to be greater
than 2 Gigabytes.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item The configuration variable \Macro{JAVA\_MAXHEAP\_ARGUMENT} now
defaults to the value \Opt{-Xmx1024m}.  The installation process of
Condor resets this value to \Expr{UNDEFINED} in the local
configuration file, if the detected JVM is not from Sun Microsystems.

\item A new feature has been added to the \Condor{master} that makes
it possible to append to the \MacroNI{DC\_DAEMON\_LIST} configuration
variable, instead of overwriting it.  To take advantage of this, place
the plus character ('\verb@+@') as the first character in the
\MacroNI{DC\_DAEMON\_LIST} definition.  For example:
\begin{verbatim}
  DAEMON_LIST     = NEW_DAEMON
  DC_DAEMON_LIST  = +NEW_DAEMON
\end{verbatim}

% PR 959
\item The new configuration variable \Macro{DAGMAN\_COPY\_TO\_SPOOL}
controls whether the \Condor{dagman} binary gets copied to the spool
directory when a DAG is submitted.  See \ref{param:DAGManCopyToSpool}
for details.

% PR 964
\item Added \Opt{-version} and \Opt{-help} command line options to
\Condor{submit\_dag}.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug in the \Condor{collector} which could cause it
to hang indefinitely while reading network input in rare conditions.

\item Fixed a bug in \Condor{chirp} for Windows which was causing it
to crash on invocation.

\item Fixed a bug in the Windows \Condor{mail} program, which was causing
it to become unresponsive when run.  If left running, the application also
increased its memory consumption.

\item Fixed a bug that could cause the \Condor{schedd} to never
evaluate periodic expressions.

\item Fixed a bug on Unix platforms where \Condor{configure} would
provide incorrect defaults for the \MacroNI{JAVA\_MAXHEAP\_ARGUMENT}
attribute in the installed configuration files. The new current
default for Sun Java JVMs is \Opt{-Xmx1024m}.

\item Fixed a bug on Unix platforms where \Condor{configure} would
imply that using the Unix user \Login{root} or UID 0 for the
\Opt{--owner} option is a good thing.  It is not, and would then complain
that it could not find user \Login{root} in the password file.

\item Fixed a bug on Unix platforms where \Condor{configure} would
emit errors about not being able to execute \Prog{ldd} when installing
Condor on the Mac OS X 10.5 platform.  \Condor{configure} now
correctly detects shared library requirements when installing the
Condor binaries on the Mac OS X 10.5 platform.

\item Fixed a bug where execute-side daemons started before the
\Condor{credd} would fail to match with Windows jobs with
\SubmitCmd{run\_as\_owner} set.  This condition persisted until the
execute-side daemons were either restarted or reconfigured.

\item Fixed a problem affecting the Job Router and Condor-C.  When jobs
spool input files, they enter a temporary hold state, which could
trigger actions by a naive periodic remove or release expression.
Periodic expressions are no longer evaluated when in this temporary
hold state, which has the hold reason \AdStr{Spooling input data files}.

\item The example init script \Prog{condor.boot.generic} erroneously claimed
that the \Condor{master} would begin sending SIGKILL to child
processes after 20 seconds if SIGQUIT (the fast shutdown) failed.  The
\Condor{master} will actually wait \MacroUNI{SHUTDOWN\_FAST\_TIMEOUT}
seconds, a value that currently defaults to 300 seconds.

\item Environment variable names are now properly treated as
case-insensitive on Windows. The most common symptom of this bug was
the inability to specify a custom \Env{PATH} environment variable
for a job from its submit description file.

\item Changed \Condor{submit} \Opt{-debug} to issue a warning when ignoring
environment variables. This occurs with \SubmitCmd{getenv = True} set
in a submit description file.

\item Fixed a long-standing memory leak in SOAP interface.
This caused the leak of a few hundred bytes of memory for each connection.
This could eventually have caused the \Condor{schedd} daemon to crash.

\item Fixed Job Router hooks so that their output is properly
propagated where appropriate.

\item Implemented a fix for the \Condor{startd} that prevents it from
crashing if the user specified the configuration variable
\MacroNI{NUM\_SLOTS\_TYPE\_N}, without also specifying \MacroNI{SLOT\_TYPE\_N}.

\item The sample configuration files now correctly set the default
universe to vanilla.  This default has been true since 7.2.0,
but was not reflected in the sample configuration files.

\item Fixed a bug that incorrectly set the value of the
job ClassAd attribute \Attr{RequestMemory} to be 1024 times its
correct size due to a mismatch in units;
the attribute \Attr{RequestMemory} is given in Mbytes, while
the attribute \Attr{ImageSize} is given in Kbytes.

\item Fixed a memory leak in \Condor{dagman} that leaked a small
amount of memory for each job submitted.

\item Fixed a bug that was causing the network mask to be advertised
as a Condor sinful string, rather than a dotted-quad.

\item Fixed a handle leak in the \Condor{procd} on Windows.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item Added a FAQ entry for Windows describing how machines
with miss-configured performance counters may cause the \Condor{procd}
to crash.

\item Added a manual page for the command \Condor{router\_history}.

\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-2-0}Version 7.2.0}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item A bug in some older Xen kernels can result in Condor errors
due to a broken assumption in the \Condor{procd} daemon.
See the FAQ entry at section~ \ref{sec:xen-jiffies-bug} for details.

\item A problem has been discovered when using snapshot disks with 
\SubmitCmd{vm} universe VMware jobs,
if the path that the \Condor{vm-gahp} uses to refer to the
virtual machine's VMX file contains a symbolic link.
See the FAQ entry at section~ \ref{sec:vmware-symlink-bug} for details.

\item The name of the Amazon EC2 GAHP binary has changed from
\Prog{amazon-gahp} to \Prog{amazon\_gahp}. This makes it consistent
with the naming of other Condor binaries.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item The default \SubmitCmd{universe} for jobs is now 
\SubmitCmd{vanilla}, instead of \SubmitCmd{standard}.
The default can be changed using the configuration variable
\Macro{DEFAULT\_UNIVERSE}.

\item VMware \SubmitCmd{vm} universe jobs now have any BIOS settings saved in
an \File{nvram} file in the \SubmitCmd{vmware\_dir} given in the
job's submit file transferred to the execute machine, so that they
apply to the job's execution.

\item Daemons that become unresponsive are now killed using the
SIGABRT signal, which causes a core file to be dropped.
Setting the configuration variable \Macro{NOT\_RESPONDING\_WANT\_CORE}
to \Expr{False} will revert to the previous behavior that used
the SIGKILL signal.

\item The \Condor{job\_router} and the
\Condor{q} command with the \Opt{-better-analyze} option now
support more ClassAd functions than they previously did.  They now
support all ClassAd functions, except for those with names beginning
with the string \Code{stringList}.

\item \Condor{status} given the options \Opt{-submitters} \Opt{-xml}
no longer emits a single blank line when there are no submitters,
instead it prints valid XML output with an empty body.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item The HAD configuration variable \MacroNI{NEGOTIATOR\_STATE\_FILE}
has changed its name to \MacroNI{STATE\_FILE}.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item \Security A flaw was found and fixed that could allow an unauthenticated
user to cause Condor daemons to shut down,
and could allow running jobs to be removed from the queue.

% PR 952
\item Fixed a bug that caused \Condor{dagman} to stay in the Condor
queue, if \Condor{dagman} was accidentally submitted with an empty DAG
input file.

% PR 959
\item \Condor{submit\_dag} now generates a \File{.condor.sub} file with
the submit description file command \SubmitCmd{copy\_to\_spool}
set to \Expr{True}, to ease version upgrades while
large DAGs are running.

\item Fixed a problem in the \Condor{startd} when using
\MacroNI{STARTD\_SLOT\_EXPRS} for attributes that are sometimes
present and sometimes absent from the machine ClassAd.  This is most
typical of attributes that enter the machine ClassAd from the job, via
\MacroNI{STARTD\_JOB\_EXPRS}.  When the attribute went away from slot X
(for example, because the job on slot X finished), the corresponding
\MacroNI{SlotX\_<AttributeName>} attribute was not reliably removed from
all of the other slots.

\item Removed some redundant information from the \Condor{startd} 
advertisements to the \Condor{collector}, 
from within the private ClassAd that is not user-visible.
This fix reduces UDP traffic and memory usage generated by
the \Condor{startd} by about 20\Percent\
in the \Condor{collector} and \Condor{negotiator} daemons.

\item Fixed the \Condor{master} daemon to correctly preserve all command-line
arguments when restarting itself.  In some cases, not preserving \Code{argv[0]}
confused external utilities that monitor the \Condor{master} process by looking
at the output of \Prog{ps} or similar programs.  Also, not preserving
\Opt{-pid} and \Opt{-runfor} could cause unexpected behavior.

\item Fixed a bug that exhibited itself when
the configuration variable \MacroNI{NEGOTIATOR\_CONSIDER\_PREEMPTION}
was set to \Expr{False}, in which jobs
would not be matched to slots in the backfill state.  Corrected, slots doing
backfill are included in the matchmaking process.

\item The \Condor{job\_router} did not work while managing jobs from
multiple users when read access to the \Condor{schedd} required
authentication.  The \Condor{job\_router} was also not able to use
authentication methods other than FS.  Now it can use any
authentication method, as long as the resulting identity is listed in
the configuration variable
\MacroNI{QUEUE\_SUPER\_USERS} or the \Condor{job\_router} and
\Condor{schedd} are running as a Personal Condor in non-root mode.

% Commented out by Karen, as it provides no relevant information
% in the given form.
% \item Fixed a number of memory leaks.

\item Fixed a bug in the \Condor{schedd} daemon that could cause it to write
  an incorrect Unique ID to the event log's header.

\item Fixed a bug in the user log reader API that could cause it to
  incorrectly return a ULOG\_NO\_EVENT in rare cases.

\item Fixed a bug in the user log reader API that could cause it to
  crash if the application attempted to re-initialize the ReadUserLog
  object.  The code now detects this condition, and returns an error
  when the application attempts to re-initialization an already
  initialized ReadUserLog object.

\item Fixed a bug that limited the size of \File{stdin}, \File{stdout},
and \File{stderr} files in the vanilla universe to 2GBytes.

\item Fixed a bug that could cause the \Condor{starter} to EXCEPT upon 
completion or eviction of a \SubmitCmd{vm} universe job.
The error message that appeared in the \File{StarterLog} file was
\begin{verbatim}
  Write_Pipe: invalid pipe end
\end{verbatim}

\item When a held job is removed, the values of the attributes
\Attr{HoldReason}, \Attr{HoldReasonCode} and \Attr{HoldReasonSubCode}
are moved to \Attr{LastHoldReason}, \Attr{LastHoldReasonCode} and
\Attr{LastHoldReasonSubCode}. Before, a hold reason could be lost if a
removed job was subsequently held.

\item The executable attribute for amazon grid universe jobs no longer
needs to be a valid file path.

\item Improved error reporting when a Xen or VMware command fails in the
\SubmitCmd{vm} universe.

\item For \SubmitCmd{vm} universe jobs,
virtual floppy disks are no longer disabled.

\item Fixed a bug introduced in Condor 7.1.4 that caused Condor to
ignore the virtual machine status reported by Xen in the \SubmitCmd{vm} universe.

\item Fixed a 20-second delay in the start up of the \Condor{c-gahp} and
the \Condor{vm-gahp}.

\item Fixed a bug which caused the net mask to be published
  into the machine ClassAd incorrectly.

\item Fixed a bug introduced in Condor 7.1.4 which could cause any
  Condor daemon to crash if the level of debugging output \MacroNI{D\_ALL}
  is enabled when a \Condor{reconfig} command is issued.

\item Fixed a bug introduced in Condor 7.1.4 which caused standard universe
jobs to fail to start up, if security authentication, but not encryption was
enabled between the submit side and the execute side.

% Commented out by Karen, as it gives no relevant information to any
% reader of this version history.  
%\item Many bugs fixed in the \Condor{job\_router} hooks.

\item Fixed a bug with streaming \File{stdin}, \File{stdout}, and
\File{stderr} when using \Prog{glexec}.

% Commented out by Karen, as it gives no relevant information to any
% reader of this version history, and has nothing to do with bugs fixed.
% \item Many improvements in error propagation and debugging output.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item Initial documentation for dynamic provisioning is available
in section~ \ref{sec:SMP-dynamicprovisioning}.

\item Documentation for Kerberos authentication
(see section~ \ref{sec:Kerberos-Authentication})
and associated configuration variables has been updated.

\end{itemize}

