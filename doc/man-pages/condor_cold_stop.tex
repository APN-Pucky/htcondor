\begin{ManPage}{\label{man-condor-cold-stop}\Condor{cold\_stop}}{1}
{reliably shuts down and uninstalls a running Condor instance}

\Synopsis \SynProg{\Condor{cold\_stop}}
\oOpt{-force}
\OptArg{-configfile}{file}
\oOptArg{-basedir}{directory}
\oOptArg{-localdir}{directory}
\oOptArg{-runlocalconfig}{file}
\oOpt{-cleaninstall}
\oOpt{-cleanlocal}
\oOpt{-stop}
\oOptArg{-logarchive}{archive}
\oOptArg{-spoolarchive}{archive}
\oOptArg{-execarchive}{archive}
\oOpt{-flock}
\oOpt{-pid}
\oOptArg{-artifact}{file}
\oOpt{-nogurl}
\oOptArg{-globuslocation}{directory}

\index{Condor commands!condor\_cold\_stop}
\index{Deployment commands!condor\_cold\_stop}
\index{condor\_cold\_stop}

\Description 
\Condor{cold\_stop} reliably shuts down and uninstalls a
running Condor instance.  
This program first uses \Condor{local\_stop} to
reliably shut down the running Condor instance.
It then uses \Condor{cleanup\_local} to create and store archives of the
\File{log}, \File{spool}, and \File{execute} directories.
Its last task is to 
uninstall the Condor binaries and libraries using \Prog{cleanup\_release}.

\begin{Options}
  \OptItem{\OptArg{-artifact}{file}}{
    Uses \Arg{file} as the artifact file to determine whether the
    Condor Master is still alive. 
  }
  \OptItem{\OptArg{-basedir}{directory}}{
    Directory where the Condor installation can be found.  Defaults to
    the current working directory.
  }
  \OptItem{\Opt{-cleaninstall}}{
    The program will remove the Condor installation.  If none of the
    following options are provided: \Opt{-cleaninstall},
    \Opt{-cleanlocal}, or \Opt{-stop}; the program behaves as though
    all of them have been provided.
  }
  \OptItem{\Opt{-cleanlocal}}{
    The program will remove the \File{log}, \File{spool}, \File{exec}
    directories for this Condor instance.  If none of the following
    options are provided: \Opt{-cleaninstall}, \Opt{-cleanlocal}, or
    \Opt{-stop}; the program behaves as though all of them have been
    provided.
  }
  \OptItem{\OptArg{-configfile}{file}}{
    The same configuration file path given to \Condor{cold\_start}.
    This program assumes the file is in the installation directory or
    the current working directory. 
  }
  \OptItem{\OptArg{-execarchive}{archive}}{
    The program will create a tar'ed and gzip'ed archive of the
    \File{execute} directory and stores it as \Arg{archive}.  The
    \Arg{archive} can be a file path or a grid-ftp url.
  }
  \OptItem{\Opt{-flock}}{
    The program will determine whether the \Condor{master} daemon
    has exited
    using a file lock undertaker.  This option must match the
    corresponding option given to \Condor{cold\_start}.
  }
  \OptItem{\Opt{-force}}{
    The program will ignore the status of the schedd, whether it has
    jobs in the queue or not, when shutting down Condor.
  }
  \OptItem{\OptArg{-globuslocation}{directory}}{
    The directoy containing the Globus installation.  This option is
    required if any of the \Opt{-*archive} options are used and Globus
    is not installed in \File{/opt/globus}.
  }
  \OptItem{\OptArg{-localdir}{directory}}{
    Directory where the \File{log}, \File{spool}, and \File{execute}
    directories are stored for this running instance of Condor.
    Required if the \Opt{-cleanlocal} option is specified.
  }
  \OptItem{\OptArg{-logarchive}{archive}}{
    The program will create a tar'ed and gzip'ed archive of the
    \File{log} directory and stores it as \Arg{archive}.  The
    \Arg{archive} can be a file path or a grid-ftp url.
  }
  \OptItem{\Opt{-nogurl}}{
    This program will not use \Prog{globus-url-copy} to store the
    archives.  This means that the archives can only be stored on
    mounted file systems.
  }
  \OptItem{\Opt{-pid}}{
    The program will determine whether the \Condor{master} daemon
    has exited
    using a unique process id undertaker.  This option must match the
    corresponding option given to \Condor{cold\_start}.
  }
  \OptItem{\OptArg{-runlocalconfig}{file}}{
    Binds \Arg{file} into the configuration used by this instance of
    Condor.  This option should be provided here, if it was provided to
    \Condor{cold\_start}.
  }
  \OptItem{\OptArg{-spoolarchive}{archive}}{
    The program will create a tar'ed and gzip'ed archive of the
    \File{spool} directory and stores it as \Arg{archive}.  The
    \Arg{archive} can be a file path or a grid-ftp url.
  }
  \OptItem{\Opt{-stop}}{
    The program will shutdown this running instance of Condor.  If
    none of the following options are provided: \Opt{-cleaninstall},
    \Opt{-cleanlocal}, or \Opt{-stop}; the program behaves as though
    all of them have been provided.
  }
\end{Options}

\ExitStatus
\Condor{cold\_stop} will exit with a status value of 0 (zero) upon
success, and non-zero otherwise.

\Examples

To shutdown a Condor instance on the target machine:

\begin{verbatim}
% condor_cold_stop -configfile condor_config.mobile
\end{verbatim}

To shutdown a Condor instance and archive the log directory:

\begin{verbatim}
% condor_cold_stop -configfile condor_config.mobile \
  -logarchive /tmp/log.tar.gz
\end{verbatim}

\SeeAlso
\Condor{cold\_start} (on page~\pageref{man-condor-cold-start}),
\Prog{flock\_undertaker} (on page~\pageref{man-flock-undertaker}), 
\Prog{uniq\_pid\_undertaker} (on page~\pageref{man-uniq-pid-undertaker}).

\end{ManPage}
