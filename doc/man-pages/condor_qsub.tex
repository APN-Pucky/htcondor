\begin{ManPage}{\label{man-condor-qsub}\Condor{qsub}}{1}
{Queue jobs for execution under HTCondor with PBS/SGE style submission}
\Synopsis \SynProg{\Condor{qsub}}

\oOptArg{-a}{date\_time}
\oOptArg{-A}{account\_string}

\Description

The primary purpose of this emulation is to allow PBS/Torque-style and 
SGE-style submission of dependent jobs without the need to specify the full
dependency graph at submission time. This implementation is neither as efficient
as HTCondor's DAGMan, nor as functional as SGE's qsub/qalter. It merely serves 
as a minimal adaptor to be able to use software original written to interact 
with PBS/Torque/SGE in an HTCondor pool. In Version 0.2, many additional 
features have been added.

In general \Condor{qsub} behaves just like qsub. However, only a fraction of the
original functionality is available (about 1/3). The following list of options only
describes the differences in the behavior of PBS/Torque/SGE's qsub and this 
emulation. Qsub options not listed here are not supported.

For a full listing of options, please see
\begin{itemize}
POSIX: \URL{http://pubs.opengroup.org/onlinepubs/9699919799/utilities/qsub.html}
SGE: \URL{http://gridscheduler.sourceforge.net/htmlman/htmlman1/qsub.html}
PBS/Torque: \URL{http://docs.adaptivecomputing.com/torque/4-1-3/Content/topics/commands/qsub.htm}
\end{itemize}

\Condor{qsub} is a shell script that submits jobs to HTCondor for execution, but 
uses the syntax of Torque/PBS or SGE/Open Grid Scheduler. \Condor{qsub} accepts
both command line options and arguments or a single file that contains all of the 
commands. This works in the reverse direction of \SubmitCmd{grid} universe's 
\SubmitCmd{batch} grid type (see section~\ref{sec:batch} on 
page~\pageref{sec:batch}), which takes HTCondor jobs submitted with HTCondor
syntax and submits them to PBS, SGE, or LSF.

Some concepts present in PBS/SGE do not apply to HTCondor and so these options are
not enabled.

\begin{Options}
\OptItem{\OptArg{-a}{date\_time}}{(BLANK option)
  Specifies a defered execution date and time (see 
  We follow the PBS/Torque implementation of this option. The \Arg{date\_time} 
  argument is a string in the form \Arg{[[[[CC]YY]MM]DD]hhmm[.SS]}.  
  \Arg{CC}, \Arg{YY}, \Arg{MM}, \Arg{DD}, and \Arg{SS} are optional. SGE does not
  permit \Arg{MM} or \Arg{DD} to be optional, although PBS does; 
  we follow the PBS style.}
%
%  \begin{verbatim}
%  [[[[CC]YY]MM]DD]hhmm[.SS]
%  \end{verbatim}
%  whereas MM and DD are potentially optional. SGE does not permit MM or DD to be 
%  optional.}
\OptItem{\OptArg{-A}{account\_string}}{(BLANK Option)
  Allows you to use group accounting (see section \ref{sec:group-accounting} on 
  page \pageref{sec:group-accounting}) and have the string \Arg{account\_string} 
  be the accounting group associated with this job. Unlike SGE, we do not give a
  default group of \"sge\".}
\OptItem{\OptArg{-b}{y|n}}{(BLANK Option)
  Tells \Condor{qsub} whether the command given to \Condor{qsub} should be treated
  as a binary or as a script. This option follows the SGE version 
}
\OptItem{\OptArg{-c}{checkpoint_options}}{(BLANK Option)  
  Standard universe only. By default, HTCondor uses checkpointing and this option
  controls the how HTCondor checkpoints. Currently, these options from POSIX,
  SGE, and PBS are the only ones that work.
  \begin{description}
  \item[n/N] Disable checkpointing.
  \item[s/S] Disable periodic checkpointing. A job will only checkpoint when it
    is evicted.
  \end{description}}
\OptItem{\Opt{--condor-keep-files}}{(BLANK Option)
  \Condor{qsub} specific. \Condor{qsub} creates some temporary files (generated
  HTCondor submit files, sentinel jobs) and using this option will cause these 
  files to remain around after \Condor{qsub} finishes. Mostly important for
  debugging.}
\OptItem{\Opt{-cwd}}{(BLANK Option}
  If this option is present, the initial directory in which the job will run 
  will be set to the current 
  directory from where the job was submitted from. It sets 
  \SubmitCmd{initialdir} for \Condor{submit} to the current directory.}
\OptItem{\OptArg{-d}{path} or \OptArg{-wd}{path}}{(BLANK Option)
  Specifies the initial directory to be the to the value given by
  \Arg{path}. It sets \SubmitCmd{initialdir} for \Condor{submit} to \Arg{path}.
  See \ref{man-condor-submit-initialdir} on page 
  \pageref{man-condor-submit-initialdir} for further explanation of 
  \SubmitCmd{initialdir}.}
\OptItem{\OptArg{-e}{filename}}{(BLANK Option)
  Specifies the file which should contain the standard error stream. See 
  \ref{man-condor-submit-error} on page \pageref{man-condor-submit-error}.}
\OptItem{\OptArg{-f}{qsub\_file}}{(BLANK Option)
  \Condor{qsub} specific. \Condor{qsub} nominally accepts command line arguments. 
  However, submissions to \Shell{qsub} are often done in a batch
  file with commands like \Env{#PBS} or \Env{#SGE}. When this option is used,
  \Condor{qsub} will parse the batch file listed as \Arg{qsub\_file}. This 
  command may be replaced with \Opt{-@} in the future to emulate SGE's 
  implementation of dealing with these kinds of files.}
\OptItem{\Opt{-h}}{(BLANK Option)
  Job submitted with this option gets placed into the hold state at submission
  time.}
\OptItem{\Opt{--help}}{(BLANK Option)
  \Condor{qsub} will print out a help message. Please refer to this manual page
  as it is more complete and up to date than the help message. We hope to
  synchronize them soon.}
\OptItem{\OptArg{-hold\_jid}{<jid>}}{(BLANK Option)
  If given, the job will be submitted in the hold state. Along with the actual 
  job, a `sentinel' job will be submitted to HTCondor's local universe. This 
  sentinel then watches the specified job and releases the submitted job whenever
  the job has completed. The sentinel observes HTCondor's queue and history
  to detect a job exiting with code 100 and not start the depedent job in this 
  case. If a cluster id of an array job is given, the dependent job will only be 
  released after all individual jobs of a cluster have completed.}
\OptItem{\OptArg{-i}{[[hostname]:]file,...}}{(BLANK Option)
  NEED TEXT
}
\OptItem{\OptArg{-j}{characters}}{(BLANK Option)
  Determines if the standard error stream and the standard output stream of the
  job will be merged into one stream. For HTCondor, this means merging them into
  one file that will eventually be placed back into the submitting directory.}
\OptItem{\OptArg{-l}{resource\_spec}}{(BLANK Option)
  Specifies various requirements for the job, e.g.~amount of RAM, number of CPUs.
  We currently support only PBS style resource requests, though we hope to have 
  SGE options soon.
  \Arg{resource\_spec} is a comma separated list of the form:
\begin{verbatim}
resource_name[=[value]][,resource_name[=[value]],...]
\end{verbatim}
where \Arg{resrouce\_name} and \Arg{value} take the following values with the 
following meanings:
\begin{tabular}{|c|c|l|} \hline
\Arg{resource\_name} & \Arg{value} & Description \\ \hline
arch  & string & \\ Should use HTCondor's value \ref{Arch-machine-attribute} \hline
file  & integer\footnotemark[size] & Amount of disk space requested. \\ \hline
host  & string & Name of the host machine on which the job should run. For HTCondor,
this means that no other machines may run this job. \\ \hline
mem   & integer\footnotemark[size] & Amount of memory requested.\\ \hline
nodes & 
\begin{verbatim}
{<node_count> |
<hostname>} [:ppn=<ppn>][:gpus=<gpu>]
[:<property>[:<property>]...] [+ ...]
\end{verbatim}
& Number and/or properties of nodes to be used. Please see 
\URL{http://docs.adaptivecomputing.com/torque/4-1-3/Content/topics/2-jobs/requestingRes.htm#qsub} 
for examples. We are working on having arbitary properties be supported. \\ \hline
opsys & string & Specify which OS whould be used. See 
\ref{OpSys-machine-attribute} on page \pageref{OpSys-machine-attribute} for 
permitted options. \\ \hline
procs & procs=<integer>  & Number of CPUs requested \\ \hline  
\end{tabular}
\footnotetext[size]{PBS/Torque defaults to having the value represent the number of 
bytes; HTCondor defaults to using kilobytes. Both recognize the appending of 
kb, mb, gb, and tb. We do not currently support the use of words (w, kw, mw, gw, and
tw).}}
\OptItem{\OptArg{-m}{a|e|n}}{(BLANK Option)
Set notification level. See \ref{man-condor-submit-notification} on page 
\pageref{man-condor-submit-notification} for how \Condor{submit} handles 
notification. When an e-mail is sent to the owners of an HTCondor job depens on 
the settings. These settings are:
\begin{description}
\item[a] Mail is sent when the job terminates abnormally.
\item[e] Mail is sent when the job terminates.
\item[n] Mail is not sent.
\end{description}
There are two additional options that may become supported in the future:
\begin{description}
\item[b] UNSUPPORTED. Mail is sent when the job commences execution.
\item[s] UNSUPPORTED. Mail is sent when the job is suspended.
\end{description}
}
\OptItem{\OptArg{-M}{e-mail address}}{(BLANK Option)
Sets the e-mail address to use when HTCondor sends e-mail. See 
\ref{man-condor-submit-notify-user} on page \pageref{man-condor-submit-notify-user}
for further details.}
\OptItem{\OptArg{-o}{filename}}{(BLANK Option)
  Specifies the file which should contain the standard error stream. See 
  \ref{man-condor-submit-output} on page \pageref{man-condor-submit-output}.}
\OptItem{\OptArg{-p}{integer}}{(BLANK Option)
Sets the priority, with 0 being the default. Jobs with higher numerical priority will
run before jobs with lower numerical priority.
See \ref{man-condor-submit-priority} on page \pageref{man-condor-submit-priority}
for more information.}
\OptItem{\Opt{--print}}{(BLANK Option) 
\Condor{qsub} specific. Prints to \File{stdout} the contents of the HTCondor submit
file that \Condor{qsub} generates.}
\OptItem{\OptArg{-r}{y|n}}{(BLANK Option)
Specifies whether or not a job is rerunnable. Normally, HTCondor tries to rerun jobs,
so this tries as best as possible ensure that this does not occur. \Arg{y} is the 
default value.}
\OptItem{\OptArg{-S}{shell}}{(BLANK Option)
Specifies the path to the shell that should interpret the job.}
\OptItem{\OptArg{-t}{<start>[-<stop>[:<step>]]}}{(BLANK Option)
Specifies that this array jobs a number of essentially identical jobs should be
submitted. Currently, only the SGE style syntax is supported. \Arg{start}, 
\Arg{stop}, and \Arg{step} are all integers. \Arg{start} is the start index of the 
jobs, \Arg{stop} is the end index (inclusive) of the jobs, and \Arg{step} is the 
step size of the indices.
\WARN Currently, trying to use more than more than one processor or 
node in a job will not work with this option.}
\OptItem{\Opt{--test}}{(BLANK Option)
\Condor{qsub} specific. It makes \Condor{qsub} not submit the job, but \Condor{qsub}
will still generate an HTCondor submit file.}
\OptItem{\OptArg{-v}{variable list}}{(BLANK Option)
\Arg{variable list} is a comma separated string with the format of
\Env{variable[=value][,variable[=value],...]}. Since \Env{[=value]} can be optional
and HTCondor does not accept a variable without a value, \Condor{qsub} appends 
\Env{=True} to the variable listed. Note that this option does not handle whitespace
well as they must be contained by quotes. Also, all single and double quotes need to
be escaped by backslashes.
}
\OptItem{\Opt{-V}}{(BLANK Option)
  If given, HTCondor will copy all of the user's current shell environment variables
for submissiong by having 'getenv = True' added to the HTCondor submit file. See 
section \ref{man-condor-submit-getenv} on page \pageref{man-condor-submit-getenv} 
for more details.}
\OptItem{\OptArg{-W}{attr\_name=attr\_value[,attr\_name=attr\_value...]}{
(BLANK Option)
PBS/Torque supports a number of attributes. However, \Condor{qsub} only supports
the names \Arg{stagein} and \Arg{stageout} for \Arg{attr\_name}.
The format of \Arg{attr\_value} for \Arg{stagein} and \Arg{stageout} is
\Env{local\_file@hostname:remote\_file[,...]} and we strip it to 
\Env{remote\_file[,...]}. HTCondor's file transfer mechanism is then used if needed.}
\OptItem{\Opt{--version}}{(BLANK Version)
  Print version information of \Condor{qsub} and exit.}
\end{Options}

\end{ManPage}
