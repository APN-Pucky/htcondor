%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\label{sec:Pool-Management}Pool Management}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Condor provides administrative tools to help with
pool management.
The following sections describe some of these various tasks.

All of the commands described in this section are subject to the
security policy chosen for the Condor pool.
As such, the commands must be either run from a
machine that has the proper authorization, 
or run by a user that is authorized to issue the commands.
Section~\ref{sec:Security} on
page~\pageref{sec:Security} details the implementation of 
security in Condor.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:Pool-Shutdown-and-Restart}
Shutting Down and Restarting a Condor Pool}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\Todo
%The best way to shut down a pool is to take advantage of the remote
%administration capabilities of the \Condor{master}.
%The first step is to save the IP address and port of the
%\Condor{master} daemon on all of the machines to a file, so that 
%even if the case that the \Condor{collector} is shut down, one can still send
%administrator commands to the different machines.
%Use the following command:
%\footnotesize
%\begin{verbatim}
  %% condor_status -master -format "%s\n" MasterIpAddr > addresses
%\end{verbatim}
%\normalsize

%The first step to shutting down the pool is to stop any currently
%running jobs, and give them a chance to produce a checkpoint.
%Depending on the size of the pool, the network infrastructure, and
%the image-size of the standard jobs running on the pool,
%this may logically be
%a slow process, only vacating one host at a time.
%Either shut down hosts that have jobs submitted (in which case
%all the jobs from that host will try to produce a checkpoint simultaneously),
%or shut down individual hosts that are running jobs.
%To shutdown a host, issue the command:
%\begin{verbatim}
  %% condor_off hostname
%\end{verbatim}
%where \Opt{hostname} is the name of the host to be shut down.
%This only works so long as the \Condor{collector} is still
%running.
%Once Condor is shut down on the central manager,
%rely on the \File{addresses} file already created.
%
%If all the running jobs have produced a checkpoint and stopped,
%or if not
%worried about the network load caused by shutting down
%everything at once, it is safe to turn off all daemons on all machines
%in the pool.
%Do this with a single command, issued from an authorized
%administrator machine:
%\begin{verbatim}
  %% condor_off -all
%\end{verbatim}
%
%\Condor{off} will shut down all the daemons, but leave the
%\Condor{master} running, so that a future \Condor{on} will work.
%
%Once all of the Condor daemons (except the \Condor{master}) on each
%host is turned off, all is done.
%It is now safe to install new binaries, move the checkpoint server
%to another host, or any other task that requires the pool to be
%shut down to successfully complete.
%

%Once all preliminary tasks are done and
%it is time to restart the pool, send a
%\Condor{on} to all the \Condor{master} daemons on each host.
%Do this with a single command, issued from an authorized
%administrator machine:
%\begin{verbatim}
  %% condor_on `cat addresses`
%\end{verbatim}
%At this point, all the daemons should now be restarted, and the pool
%will be back on its way.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:Reconfigure-Pool}Reconfiguring a Condor Pool}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

To change a global configuration variable and have all the
machines start to use the new setting, send a
\Condor{reconfig} command to each host.
Do this with a \emph{single} command,
\begin{verbatim}
  condor_reconfig -all
\end{verbatim}

If the global configuration file is not shared among all the machines,
as it will be if using a shared file system,
the change must be made to each copy of the global configuration file
before issuing the \Condor{reconfig} command.

Issuing a \Condor{reconfig} command is inadequate for some
configuration variables.
For those, a restart of Condor is required.
Those configuration variables that require a restart are listed in
section~\ref{sec:Macros-Requiring-Restart}
on page~\pageref{sec:Macros-Requiring-Restart}.
The manual page for \Condor{restart} is at
~\ref{man-condor-restart}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{admin-man/dynamic-attributes.tex}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

