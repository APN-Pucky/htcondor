#!/usr/bin/env perl

######################################################################
# $Id: platform_post,v 1.1.2.4 2005-02-24 05:25:11 parag Exp $
# post script to cleanup platform-specific files on the submit side
######################################################################

# we just want to chmod everything in the local directory (the
# per-platform directory on the submit side, after everything was
# transfered back) to be world-readable so that other folks can see
# the results.  until Condor's file transfer mechanism preserves
# permissions, we'll have to use this hack. :(

system("chmod a+r *");

if ( -f "test_ids" ) {
    print "Submitting test job for platform $ENV{NMI_PLATFORM} ...\n";
    system( "nmi_glue/test_submit/condor_test_submit.pl ".
            "--nightly --platform=$ENV{NMI_PLATFORM}" );
    my $status = $?;
    if( $status ) {
        die "condor_test_submit.pl failed with status $status\n";
    }
}
else {
    print "It seems no test_ids file was created. Not submitting a test run\n";
}

