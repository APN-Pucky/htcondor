
#####################################################################################
# MANDATORY: To setup the credmon, you must uncomment these lines:
#
use feature : OAUTH

# MANDATORY for local credmon: Uncomment this line to have submitters
# always create a credential (may conflict with Kerberos credmon)
#
# SEC_CREDENTIAL_PRODUCER = /usr/sbin/scitokens_credential_producer

# MANDATORY for enabling the transfer of credentials from submit host
# to execute hosts, if encryption is not already enabled.
# SEC_DEFAULT_ENCRYPTION = REQUIRED

#####################################################################################
#
# OPTIONAL: These are customized in many use cases.
#
#

# The issuer location; relying parties will need to be able to access this issuer to
# download the corresponding public key.
# LOCAL_CREDMON_ISSUER = https://$(FULL_HOSTNAME)

# The authorizations given to the token.  Should be of the form `authz:path` and
# space-separated for multiple authorizations.  The token `{username}` will be
# expanded with the user's Unix username.
# LOCAL_CREDMON_AUTHZ_TEMPLATE = read:/user/{username} write:/user/{username}


#####################################################################################
#
#
# OPTIONAL: These are rarely customized
#
#

# Path to the private keyfile
# LOCAL_CREDMON_PRIVATE_KEY = /etc/condor/scitokens-private.pem

# The lifetime, in seconds, for a new token.  The credmon will continuously renew
# credentials on the submit-side.
# LOCAL_CREDMON_TOKEN_LIFETIME = 1200

# Each key must have a name that relying parties can look up; defaults to "local"
# LOCAL_CREDMON_KEY_ID = local

# Prior to version 8.9.9, the credmon had to be set manually
# instead of using the config template.
if version < 8.9.9
   DAEMON_LIST = $(DAEMON_LIST), CREDD, CREDMON_OAUTH
   SEC_CREDENTIAL_DIRECTORY_OAUTH = /var/lib/condor/oauth_credentials
   TRUST_CREDENTIAL_DIRECTORY = True
   CREDMON_OAUTH = /usr/bin/condor_credmon_oauth
   SEC_CREDENTIAL_MONITOR_OAUTH_LOG = $(LOG)/CredMonOAuthLog
endif

# Prior to version 8.9.7, OAUTH parameters were not set separately.
if version < 8.9.7
   SEC_CREDENTIAL_DIRECTORY = $(SEC_CREDENTIAL_DIRECTORY_OAUTH)
   SEC_CREDENTIAL_MONITOR_LOG = $(SEC_CREDENTIAL_MONITOR_OAUTH_LOG)
endif

# Prior to version 8.9.2, CREDD_OAUTH_MODE had to be set
# to have the CredD use the OAuth2 mode of managing credentials
if version < 8.9.2
  CREDD_OAUTH_MODE = True
endif
