SRC_DIR = $(SRC_TREE)/condor_tools
CFLAGS = $(STD_C_FLAGS) $(PLATFORM_C_FLAGS) -DNEW_PROC

#if IS_SGI_IRIX53 || IS_SGI_IRIX62
C_PLUS_FLAGS = $(STD_C_PLUS_FLAGS) -DNEW_PROC -DALLOC_DEBUG 
#else
C_PLUS_FLAGS = $(STD_C_PLUS_FLAGS) -DNEW_PROC -DALLOC_DEBUG -fno-implicit-templates
#endif

#remove static for libdl.so
LDFLAGS = $(LIBDBM)

CLASSAD_LIB = ../condor_classad/expr_lib.a

SRC =  \
	config_val.C preen.C user_prio.C history.C tool.C view.C

LIB= ../condor_c++_util/cplus_lib.a $(CLASSAD_LIB) ../condor_util_lib/util_lib.a RpcLib KernLib SocketLib
LIBDIRS =../condor_util_lib ../condor_c++_util
PROGRAMS =  \
	condor_config_val condor_preen condor_view \
	condor_userprio condor_history condor test_calc

all_target( $(PROGRAMS) )
tags_target($(SRC),$(LIBDIRS))
depend_target($(SRC))

c_plus_target(condor_preen,preen.o,../condor_schedd.V6/libqmgmt.a $(LIB))
release_target(condor_preen,$(RELEASE_DIR)/sbin,EXECUTABLE_MODE)

c_plus_target(condor_config_val,config_val.o,$(LIB))
release_target(condor_config_val,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)

c_plus_target(condor_userprio,user_prio.o,$(LIB))
release_target(condor_userprio,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)

c_plus_target(condor_view,view.o,$(LIB))
release_target(condor_view,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)

c_plus_target(test_calc,test_calc.o,$(LIB))

c_plus_target(condor,tool.o,$(LIB))
copy_torelease_target(condor,sbin,condor,EXECUTABLE_MODE)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_on)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_off)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_checkpoint)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_vacate)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_restart)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_reconfig)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_reconfig_schedd)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_reschedule)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_master_off)

c_plus_target(condor_history,history.o,$(LIB))
release_target(condor_history,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)

stripped: condor
	cp -f condor $(RELEASE_DIR)/sbin/condor
	cd $(RELEASE_DIR)/sbin; strip condor; \
		rm -f condor_on; ln condor condor_on; \
		rm -f condor_off; ln condor condor_off; \
		rm -f condor_checkpoint; ln condor condor_checkpoint; \
		rm -f condor_vacate; ln condor condor_vacate; \
		rm -f condor_restart; ln condor condor_restart; \
		rm -f condor_reconfig; ln condor condor_reconfig; \
		rm -f condor_reschedule; ln condor condor_reschedule; \
		rm -f condor_reconfig_schedd; ln condor condor_reconfig_schedd; \
		rm -f condor_master_off; ln condor condor_master_off
